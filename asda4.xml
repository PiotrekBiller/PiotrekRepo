<?xml version="1.0" encoding="UTF-8" ?>
<Module>
  <ModulePrefs
    title="Interface SVG"
    scrolling="true"/>
  <UserPref name="name0" display_name="Name" required="true"/>
  <UserPref name="address0" display_name="url" required="true"/>
  
  <UserPref name="name1" display_name="Name" required="true"/>
  <UserPref name="address1" display_name="url" required="true"/>
  
  <UserPref name="name2" display_name="Name" required="true"/>
  <UserPref name="address2" display_name="url" required="true"/>
  
  <UserPref name="name3" display_name="Name" required="true"/>
  <UserPref name="address3" display_name="url" required="true"/>
  
  <UserPref name="name4" display_name="Name" required="true"/>
  <UserPref name="address4" display_name="url" required="true"/>
  
  <Content type="html">
  <![CDATA[
  <div id=content_div></div>

  <svg height="1000" width="1000">
    <style>
            .hexagon {
            stroke: #000;
            stroke-width: 0.5px;
            }
            .siteText{
                fill: #000;
                font: 30px Helvetica, Arial, Sans-Serif;
                text-shadow: 4px 4px 6px rgba(150, 150, 150, 1);
            }
            .hexLink:hover
            .hex{
                fill: #2f7ee1;
                transform: scale(1.05);
                -webkit-transform: scale(1.05);
                transform-origin: 50% 50%;
                -webkit-transform-origin: 50% 50%;
            }
        </style>
        <script src="http://d3js.org/d3.v3.min.js"></script>
        <script>
            var startPoints = [
                {"x":300,"y":150},
                {"x":535, "y":285},
                {"x":300, "y":420},
                {"x":770, "y":150},
                {"x":770, "y":420},
                {"x":1005 , "y":285},
                {"x":535, "y":555},
                {"x":1005, "y":555},
                {"x":770, "y":695},
                {"x":300, "y":695},
                {"x":535, "y":830},
            ];
            var allBigHexagonPoints = [];
            var allSmallHexagonPoints = [];
            generateAllPointsOfHexagon();
            function generateAllPointsOfHexagon(){
                
                for(var i=0;i<startPoints.length;i++){
                    allBigHexagonPoints.push(generatePointOfBigHexagon(startPoints[i]));
                    allSmallHexagonPoints.push(generatePointOfSmallHexagon(startPoints[i]));
                }
            }
            function generatePointOfBigHexagon(startPoint){
                var points = [
                    {"x": startPoint.x , "y":startPoint.y},
                    {"x": startPoint.x-75 , "y":startPoint.y+130},
                    {"x": startPoint.x-225 , "y":startPoint.y+130},
                    {"x": startPoint.x-300 , "y":startPoint.y},
                    {"x": startPoint.x-225 , "y":startPoint.y-130},
                    {"x": startPoint.x-75 , "y":startPoint.y-130}
                ];
                return points;
            }
            function generatePointOfSmallHexagon(startPoint){
                var points = [
                    {"x": startPoint.x-80 , "y":startPoint.y-105},
                    {"x": startPoint.x-87.5 , "y":startPoint.y-92},
                    {"x": startPoint.x-102.5 , "y":startPoint.y-92},
                    {"x": startPoint.x-110 , "y":startPoint.y-105},
                    {"x": startPoint.x-102.5 , "y":startPoint.y-118},
                    {"x": startPoint.x-87.5 , "y":startPoint.y-118}
                ];
                return points;
            }
        </script>
        <script>
            var sites = {
                "Home" : "http://google.pl",
                "Departments" : "http://google.pl",
                "Channels" : "http://google.pl",
                "Solutions" : "http://google.pl",
                "Channels2" : "http://google.pl",
                "Solutions2" : "http://google.pl",
                "Channels3" : "http://google.pl",
                "Solutions3" : "http://google.pl",
            };
            drawHexagon = 
            d3.svg.line()
                    .x(function(d) { return d.x; })
                    .y(function(d) { return d.y; });


            var svgContainer = 
                d3.select("body")
                .append("svg")
                .attr("width", 200*countOfSites())
                .attr("height", 200*countOfSites());
            
            //Generate Bix Hexagon
            for(var i=0;i<countOfSites();i++){
                var enterElements = 
                svgContainer.append("a")
                            .attr("class","hexLink")
                            .attr("href","#")
                            .attr("target","_self")
                            .append("g")
                            .attr("class","nodes")
                            .append("path")
                            .attr("d", drawHexagon(allBigHexagonPoints[i]))
                            .attr("fill","#4f81c0")
                            .attr("class","hex");         
            }
            
            //Generate Small Hexagon in Big
            for(var i=0;i<countOfSites();i++){
                var enterElements = 
                svgContainer.selectAll("g:nth-child(1)")
                            .filter(function(d, j) { return j == i; })
                            .append("path")
                            .attr("d",drawHexagon(allSmallHexagonPoints[i]))
                            .attr("fill","#fff");
                
            }
            var index = 0;
            for( var key in sites)
            {
                var enterElements =
                svgContainer.selectAll("a")
                            .filter(function(d,j) {return j==index})
                            .attr("href",sites[key]);
                var text = 
                svgContainer.selectAll("g")
                            .filter(function(d,j){return j==index})
                            .append("text")
                            .attr("text-anchor", "middle")
                            .attr("class","siteText")
                            .attr("x",(allBigHexagonPoints[index][0].x - allBigHexagonPoints[index][3].x)/2 + allBigHexagonPoints[index][3].x)
                            .attr("y",allBigHexagonPoints[index][3].y)
                            .text(key);
                index++;
            }
            
            function countOfSites(){
                var count = 0;
                for(var key in sites)
                    count++;
                return count;
            }
        </script>

    


  
  <script type="text/javascript">
    main();
    
    function main()
    {
        var prefs = new gadgets.Prefs();
        
            name0 = prefs.getString("name0");
            address0 = prefs.getString("address0");
            name1 = prefs.getString("name1");
            address1 = prefs.getString("address1");
            name2 = prefs.getString("name2");
            address2 = prefs.getString("address2");
            name3 = prefs.getString("name3");
            address3 = prefs.getString("address3");
            name4 = prefs.getString("name4");
            address4 = prefs.getString("address4");
        
        var html = "";
        var sites = [
        {key:name0, value:address0},
        {key:name1, value:address1},
        {key:name2, value:address2},
        {key:name3, value:address3},
        {key:name4, value:address4},
        ];

        for(var i = 0; i < sites.length; i++)
        {
            html += sites[i].key + " = " + sites[i].value + "<br />";
        }
        
        console.log(sites);

        var sitesHtml0 = sites[0].key;
        var sitesHtml1 = sites[1].key; 
        var sitesHtml2 = sites[2].key; 
        var sitesHtml3 = sites[3].key; 
        var sitesHtml4 = sites[4].key; 

        document.getElementById("field0").innerHTML = "aaaaaaa";
        document.getElementById("field1").innerHTML = "bbbbbbb";
        document.getElementById("field2").innerHTML = sitesHtml2;
        document.getElementById("field3").innerHTML = sitesHtml3;
        document.getElementById("field4").innerHTML = sitesHtml4;

        document.getElementById("content_div").innerHTML = html;
    }
  </script>
  ]]>
  </Content>
</Module>


